# yaml-language-server: $schema=https://taskfile.dev/schema.json
---
version: '3'

includes:
  nodes:
    taskfile: ../nodes
    internal: true
    flatten: true

tasks:
  zpool-status: ssh core@{{.HOST}} 'zpool status'
  zfs-list: ssh core@{{.HOST}} 'zfs list'
  zpool-status-all: pssh -i -h ./hosts/agents 'zpool status'
  zfs-list-all: pssh -i -h ./hosts/agents 'zfs list'

  wipefs:
    prompt: About to WIPE /dev/nvme0n1 on {{.HOST}}! Are you sure you want to continue?
    cmd:
      task: on:node
      vars:
        NODE: '{{.HOST}}'
        CMD: sudo wipefs -a /dev/nvme0n1
