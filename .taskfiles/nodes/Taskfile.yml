# yaml-language-server: $schema=https://taskfile.dev/schema.json
---
version: '3'

tasks:
  on:node:
    requires:
      vars: [NODE, CMD]
    cmd: ssh core@{{.NODE}} '{{.CMD}}'

  on:*:
    requires:
      vars: [CMD]
    vars:
      HOSTS_FILE: '{{index .MATCH 0}}'
    cmd: pssh -i -h './hosts/{{.HOSTS_FILE}}' '{{.CMD}}'
