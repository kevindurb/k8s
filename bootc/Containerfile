FROM ghcr.io/ublue-os/ucore-minimal:stable-nvidia

ADD ./files/modules.conf /etc/modules-load.d/k8s.conf
ADD ./files/sysctl.conf /etc/sysctl.d/k8s.conf

RUN dnf install -y \
    kubelet \
    kubeadm \
    kubectl \
    cri-o \
    cri-o-runc && \
    dnf clean all

RUN systemctl enable cri-o.service && \
    systemctl enable kubelet.service
